<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.3.2. Numerical operations on arrays &#8212; Scipy lecture notes</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2016.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="top" title="Scipy lecture notes" href="../../index.html" />
    <link rel="up" title="1.3. NumPy: creating and manipulating numerical data" href="index.html" />
    <link rel="next" title="1.3.3. More elaborate arrays" href="elaborate_arrays.html" />
    <link rel="prev" title="1.3.1. The NumPy array object" href="array_object.html" />
   
    <link rel="stylesheet"
	  href="http://yui.yahooapis.com/pure/0.6.0/base-min.css">

<script type="text/javascript">
$(function () {
    // Highlight the table of content as we scroll
    sections = {},
    i        = 0,
    url	 = document.URL.replace(/#.*$/, ""),
    current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();

	// Highlight the current section
	$('a.internal').parent().removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            };
	    if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
	    };
        }
	$('a.internal[href$="' + current_section + '"]').parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().addClass('active');
	$('a.internal[href$="' + current_section + '"]').parent().parent().parent().parent().parent().addClass('active');
    });

});
</script>


  </head>
  <body role="document">
   <!-- Use the header to add javascript -->
    

    <script type="text/javascript">
    // Function to collapse the tip divs
    function collapse_tip_div(obj){
	// Update the representation on the tip div based on whether it
	// has the 'collapsed' css class or not: we only want to
	// collapse divs that are not already collapsed
	if($(obj).hasClass("collapsed")) {
	} else {
	    $(obj).find("p.summary").remove();
	    var content = $(obj).text();
	    var html = $(obj).html();

	    if(content.length > 40) {
		if ($.browser.msie) {
		    // We start at '3' to avoid 'tip', as IE
		    // does not count whitespace
		    var content = content.substr(3, 50);
		} else {
		    // We start at '5' to avoid 'tip '
		    var content = content.substr(5, 50);
		}
	    }
	    $(obj).html('<p class="summary"><img src="../../_static/plus.png">' + content + '...</p>' + html);
	}
    }
    </script>

    <script type="text/javascript">
    $(function () {
	$(".tip")
	    .click(function(event){
		$(this).toggleClass("collapsed");
		// Change state of the global button
		$('div.related li.transparent').removeClass('transparent')
		$(this).find("p.summary").remove();
		if($(this).hasClass("collapsed")) {
		    var content = $(this).text();
		    var html = $(this).html();

		    if(content.length > 40) {
			if ($.browser.msie) {
			    // We start at '3' to avoid 'tip', as IE
			    // does not count whitespace
			    var content = content.substr(3, 50);
			} else {
			    // We start at '5' to avoid 'tip '
			    var content = content.substr(5, 50);
			}
		    }
		    $(this).html('<p class="summary"><img src="../../_static/plus.png">' + content + '...</p>' + html);
		}
		if (event.target.tagName.toLowerCase() != "a") {
                   return true; //Makes links clickable
		}
	});
    });
    </script>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="elaborate_arrays.html" title="1.3.3. More elaborate arrays"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="array_object.html" title="1.3.1. The NumPy array object"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. Getting started with Python for science</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">1.3. NumPy: creating and manipulating numerical data</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scipy-lecture-notes/edit/master/intro/numpy/operations.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Edit it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="numerical-operations-on-arrays">
<h1>1.3.2. Numerical operations on arrays<a class="headerlink" href="#numerical-operations-on-arrays" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="section-contents">
<p class="topic-title first">Section contents</p>
<ul class="simple">
<li><a class="reference internal" href="#elementwise-operations" id="id2">Elementwise operations</a></li>
<li><a class="reference internal" href="#basic-reductions" id="id3">Basic reductions</a></li>
<li><a class="reference internal" href="#broadcasting" id="id4">Broadcasting</a></li>
<li><a class="reference internal" href="#array-shape-manipulation" id="id5">Array shape manipulation</a></li>
<li><a class="reference internal" href="#sorting-data" id="id6">Sorting data</a></li>
<li><a class="reference internal" href="#summary" id="id7">Summary</a></li>
</ul>
</div>
<div class="section" id="elementwise-operations">
<h2><a class="toc-backref" href="#id2">1.3.2.1. Elementwise operations</a><a class="headerlink" href="#elementwise-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-operations">
<h3>1.3.2.1.1. Basic operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h3>
<p>With scalars:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<div class="newline"></div><span class="go">array([2, 3, 4, 5])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">**</span><span class="n">a</span>
<div class="newline"></div><span class="go">array([ 2,  4,  8, 16])</span>
<div class="newline"></div></pre></div>
</div>
<p>All arithmetic operates elementwise:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([-1.,  0.,  1.,  2.])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([ 2.,  4.,  6.,  8.])</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">j</span>
<div class="newline"></div><span class="go">array([ 2,  3,  6, 13, 28])</span>
<div class="newline"></div></pre></div>
</div>
<p>These operations are of course much faster than if you did them in pure python:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>  
<div class="newline"></div><span class="go">10000 loops, best of 3: 24.3 us per loop</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="o">%</span><span class="n">timeit</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span> 
<div class="newline"></div><span class="go">1000 loops, best of 3: 861 us per loop</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>Array multiplication is not matrix multiplication:</strong></p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">*</span> <span class="n">c</span>                   <span class="c1"># NOT matrix multiplication!</span>
<div class="newline"></div><span class="go">array([[ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Matrix multiplication:</strong></p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([[ 3.,  3.,  3.],</span>
<div class="newline"></div><span class="go">       [ 3.,  3.,  3.],</span>
<div class="newline"></div><span class="go">       [ 3.,  3.,  3.]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercise: Elementwise operations</strong></p>
<blockquote>
<div><ul class="simple">
<li>Try simple arithmetic elementwise operations: add even elements
with odd elements</li>
<li>Time them against their pure python counterparts using <code class="docutils literal"><span class="pre">%timeit</span></code>.</li>
<li>Generate:<ul>
<li><code class="docutils literal"><span class="pre">[2**0,</span> <span class="pre">2**1,</span> <span class="pre">2**2,</span> <span class="pre">2**3,</span> <span class="pre">2**4]</span></code></li>
<li><code class="docutils literal"><span class="pre">a_j</span> <span class="pre">=</span> <span class="pre">2^(3*j)</span> <span class="pre">-</span> <span class="pre">j</span></code></li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="other-operations">
<h3>1.3.2.1.2. Other operations<a class="headerlink" href="#other-operations" title="Permalink to this headline">¶</a></h3>
<p><strong>Comparisons:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([False,  True, False,  True], dtype=bool)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([False, False,  True, False], dtype=bool)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Array-wise comparisons:</p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div><span class="go">False</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
</div>
<p><strong>Logical operations:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ True,  True,  True, False], dtype=bool)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ True, False, False, False], dtype=bool)</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Transcendental functions:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ 0.        ,  0.84147098,  0.90929743,  0.14112001, -0.7568025 ])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([       -inf,  0.        ,  0.69314718,  1.09861229,  1.38629436])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([  1.        ,   2.71828183,   7.3890561 ,  20.08553692,  54.59815003])</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Shape mismatches</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div>  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<div class="newline"></div><span class="gr">ValueError</span>: <span class="n">operands could not be broadcast together with shapes (4) (2)</span>
<div class="newline"></div></pre></div>
</div>
<p><em>Broadcasting?</em> We&#8217;ll return to that <a class="reference internal" href="#broadcasting"><span class="std std-ref">later</span></a>.</p>
<p><strong>Transposition:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># see help(np.triu)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  1.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.,  0.]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">T</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 1.,  0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><strong>The transposition is a view</strong></p>
<p>As a results, the following code <strong>is wrong</strong> and will <strong>not make a
matrix symmetric</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span>
<div class="newline"></div></pre></div>
</div>
<p class="last">It will work for small arrays (because of buffering) but fail for
large one, in unpredictable ways.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Linear algebra</strong></p>
<p class="last">The sub-module <code class="xref py py-mod docutils literal"><span class="pre">numpy.linalg</span></code> implements basic linear algebra, such as
solving linear systems, singular value decomposition, etc. However, it is
not guaranteed to be compiled using efficient routines, and thus we
recommend the use of <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/linalg.html#module-scipy.linalg" title="(in SciPy v0.18.1)"><code class="xref py py-mod docutils literal"><span class="pre">scipy.linalg</span></code></a>, as detailed in section
<a class="reference internal" href="../scipy.html#scipy-linalg"><span class="std std-ref">Linear algebra operations: scipy.linalg</span></a></p>
</div>
<div class="green topic">
<p class="topic-title first">Exercise other operations</p>
<blockquote>
<div><ul class="simple">
<li>Look at the help for <code class="docutils literal"><span class="pre">np.allclose</span></code>. When might this be useful?</li>
<li>Look at the help for <code class="docutils literal"><span class="pre">np.triu</span></code> and <code class="docutils literal"><span class="pre">np.tril</span></code>.</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="basic-reductions">
<h2><a class="toc-backref" href="#id3">1.3.2.2. Basic reductions</a><a class="headerlink" href="#basic-reductions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="computing-sums">
<h3>1.3.2.2.1. Computing sums<a class="headerlink" href="#computing-sums" title="Permalink to this headline">¶</a></h3>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">10</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<div class="newline"></div><span class="go">10</span>
<div class="newline"></div></pre></div>
</div>
<img alt="../../_images/reductions.png" class="align-right" src="../../_images/reductions.png" />
<p>Sum by rows and by columns:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<div class="newline"></div><span class="go">array([[1, 1],</span>
<div class="newline"></div><span class="go">       [2, 2]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># columns (first dimension)</span>
<div class="newline"></div><span class="go">array([3, 3])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<div class="newline"></div><span class="go">(3, 3)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># rows (second dimension)</span>
<div class="newline"></div><span class="go">array([2, 4])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<div class="newline"></div><span class="go">(2, 4)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Same idea in higher dimensions:</p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>     
<div class="newline"></div><span class="go">1.14764...</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>     
<div class="newline"></div><span class="go">1.14764...</span>
<div class="newline"></div></pre></div>
</div>
</div>
</div>
<div class="section" id="other-reductions">
<h3>1.3.2.2.2. Other reductions<a class="headerlink" href="#other-reductions" title="Permalink to this headline">¶</a></h3>
<p>&#8212; works the same way (and take <code class="docutils literal"><span class="pre">axis=</span></code>)</p>
<p><strong>Extrema:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<div class="newline"></div><span class="go">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<div class="newline"></div><span class="go">3</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index of minimum</span>
<div class="newline"></div><span class="go">0</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>  <span class="c1"># index of maximum</span>
<div class="newline"></div><span class="go">1</span>
<div class="newline"></div></pre></div>
</div>
<p><strong>Logical operations:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
<div class="newline"></div><span class="go">False</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Can be used for array comparisons:</p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">False</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="p">((</span><span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;=</span> <span class="n">c</span><span class="p">))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<div class="newline"></div><span class="go">True</span>
<div class="newline"></div></pre></div>
</div>
</div>
<p><strong>Statistics:</strong></p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<div class="newline"></div><span class="go">1.75</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<div class="newline"></div><span class="go">1.5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># last axis</span>
<div class="newline"></div><span class="go">array([ 2.,  5.])</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>          <span class="c1"># full population standard dev.</span>
<div class="newline"></div><span class="go">0.82915619758884995</span>
<div class="newline"></div></pre></div>
</div>
<p>... and many more (best to learn as you go).</p>
<div class="green topic">
<p class="topic-title first"><strong>Exercise: Reductions</strong></p>
<blockquote>
<div><ul class="simple">
<li>Given there is a <code class="docutils literal"><span class="pre">sum</span></code>, what other function might you expect to see?</li>
<li>What is the difference between <code class="docutils literal"><span class="pre">sum</span></code> and <code class="docutils literal"><span class="pre">cumsum</span></code>?</li>
</ul>
</div></blockquote>
</div>
<div class="green topic">
<p class="topic-title first">Worked Example: data statistics</p>
<p>Data in <a class="reference download internal" href="../../_downloads/populations.txt" download=""><code class="xref download docutils literal"><span class="pre">populations.txt</span></code></a>
describes the populations of hares and lynxes (and carrots) in northern
Canada during 20 years.</p>
<p>You can view the data in an editor, or alternatively in IPython (both shell and notebook):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="err">!</span><span class="n">cat</span> <span class="n">data</span><span class="o">/</span><span class="n">populations</span><span class="o">.</span><span class="n">txt</span>
<div class="newline"></div></pre></div>
</div>
<p>First, load the data into a NumPy array:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data/populations.txt&#39;</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">year</span><span class="p">,</span> <span class="n">hares</span><span class="p">,</span> <span class="n">lynxes</span><span class="p">,</span> <span class="n">carrots</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># trick: columns to variables</span>
<div class="newline"></div></pre></div>
</div>
<p>Then plot it:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">hares</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">lynxes</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">carrots</span><span class="p">)</span> 
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;Hare&#39;</span><span class="p">,</span> <span class="s1">&#39;Lynx&#39;</span><span class="p">,</span> <span class="s1">&#39;Carrot&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span> 
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../../plot_directive/pyplots/numpy_intro_4.py">source code</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_4.hires.png">hires.png</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_4.pdf">pdf</a>]</p>
<img alt="../../_images/numpy_intro_4.png" src="../../_images/numpy_intro_4.png" />
<p>The mean populations over time:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">populations</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">populations</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ 34080.95238095,  20166.66666667,  42400.        ])</span>
<div class="newline"></div></pre></div>
</div>
<p>The sample standard deviations:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">populations</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([ 20897.90645809,  16254.59153691,   3322.50622558])</span>
<div class="newline"></div></pre></div>
</div>
<p>Which species has the highest population each year?:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">populations</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="go">array([2, 2, 0, 0, 1, 1, 2, 2, 2, 2, 2, 2, 0, 0, 0, 1, 2, 2, 2, 2, 2])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="topic">
<p class="topic-title first">Worked Example: diffusion using a random walk algorithm</p>
<img alt="../../_images/random_walk.png" class="align-center" src="../../_images/random_walk.png" />
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Let us consider a simple 1D random walk process: at each time step a
walker jumps right or left with equal probability.</p>
<p class="last">We are interested in finding the typical distance from the origin of a
random walker after <code class="docutils literal"><span class="pre">t</span></code> left or right jumps? We are going to
simulate many &#8220;walkers&#8221; to find this law, and we are going to do so
using array computing tricks: we are going to create a 2D array with
the &#8220;stories&#8221; (each walker has a story) in one direction, and the
time in the other:</p>
</div>
<a class="reference internal image-reference" href="../../_images/random_walk_schema.png"><img alt="../../_images/random_walk_schema.png" class="align-center" src="../../_images/random_walk_schema.png" style="width: 100%;" /></a>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">n_stories</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of walkers</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">t_max</span> <span class="o">=</span> <span class="mi">200</span>      <span class="c1"># time during which we follow the walker</span>
<div class="newline"></div></pre></div>
</div>
<p>We randomly choose all the steps 1 or -1 of the walk:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t_max</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">steps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_integers</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_stories</span><span class="p">,</span> <span class="n">t_max</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span> <span class="c1"># Verification: all steps are 1 or -1</span>
<div class="newline"></div><span class="go">array([-1,  1])</span>
<div class="newline"></div></pre></div>
</div>
<p>We build the walks by summing steps along the time:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># axis = 1: dimension of time</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">sq_distance</span> <span class="o">=</span> <span class="n">positions</span><span class="o">**</span><span class="mi">2</span>
<div class="newline"></div></pre></div>
</div>
<p>We get the mean in the axis of the stories:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mean_sq_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sq_distance</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<p>Plot the results:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> 
<div class="newline"></div><span class="go">&lt;matplotlib.figure.Figure object at ...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_sq_distance</span><span class="p">),</span> <span class="s1">&#39;g.&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;y-&#39;</span><span class="p">)</span> 
<div class="newline"></div><span class="go">[&lt;matplotlib.lines.Line2D object at ...&gt;, &lt;matplotlib.lines.Line2D object at ...&gt;]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">r&quot;$t$&quot;</span><span class="p">)</span> 
<div class="newline"></div><span class="go">&lt;matplotlib.text.Text object at ...&gt;</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">r&quot;$\sqrt{\langle (\delta x)^2 \rangle}$&quot;</span><span class="p">)</span> 
<div class="newline"></div><span class="go">&lt;matplotlib.text.Text object at ...&gt;</span>
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../../plot_directive/pyplots/numpy_intro_5.py">source code</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_5.hires.png">hires.png</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_5.pdf">pdf</a>]</p>
<img alt="../../_images/numpy_intro_5.png" src="../../_images/numpy_intro_5.png" />
<p>We find a well-known result in physics: the RMS distance grows as the
square root of the time!</p>
</div>
</div>
</div>
<div class="section" id="broadcasting">
<span id="id1"></span><h2><a class="toc-backref" href="#id4">1.3.2.3. Broadcasting</a><a class="headerlink" href="#broadcasting" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Basic operations on <code class="docutils literal"><span class="pre">numpy</span></code> arrays (addition, etc.) are elementwise</p>
</li>
<li><p class="first">This works on arrays of the same size.</p>
<blockquote>
<div><div class="line-block">
<div class="line"><strong>Nevertheless</strong>, It&#8217;s also possible to do operations on arrays of different</div>
<div class="line">sizes if <em>NumPy</em> can transform these arrays so that they all have</div>
<div class="line">the same size: this conversion is called <strong>broadcasting</strong>.</div>
</div>
</div></blockquote>
</li>
</ul>
<p>The image below gives an example of broadcasting:</p>
<a class="reference internal image-reference" href="../../_images/numpy_broadcasting.png"><img alt="../../_images/numpy_broadcasting.png" class="align-center" src="../../_images/numpy_broadcasting.png" style="width: 100%;" /></a>
<p>Let&#8217;s verify:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0,  0,  0],</span>
<div class="newline"></div><span class="go">       [10, 10, 10],</span>
<div class="newline"></div><span class="go">       [20, 20, 20],</span>
<div class="newline"></div><span class="go">       [30, 30, 30]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([[ 0,  1,  2],</span>
<div class="newline"></div><span class="go">       [10, 11, 12],</span>
<div class="newline"></div><span class="go">       [20, 21, 22],</span>
<div class="newline"></div><span class="go">       [30, 31, 32]])</span>
<div class="newline"></div></pre></div>
</div>
<p>We have already used broadcasting without knowing it!:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># we assign an array of dimension 0 to an array of dimension 1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 2.,  2.,  2.,  2.,  2.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.,  1.,  1.],</span>
<div class="newline"></div><span class="go">       [ 1.,  1.,  1.,  1.,  1.]])</span>
<div class="newline"></div></pre></div>
</div>
<p>An useful trick:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(4,)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>  <span class="c1"># adds a new axis -&gt; 2D array</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(4, 1)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0],</span>
<div class="newline"></div><span class="go">       [10],</span>
<div class="newline"></div><span class="go">       [20],</span>
<div class="newline"></div><span class="go">       [30]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<div class="newline"></div><span class="go">array([[ 0,  1,  2],</span>
<div class="newline"></div><span class="go">       [10, 11, 12],</span>
<div class="newline"></div><span class="go">       [20, 21, 22],</span>
<div class="newline"></div><span class="go">       [30, 31, 32]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Broadcasting seems a bit magical, but it is actually quite natural to
use it when we want to solve a problem whose output data is an array
with more dimensions than input data.</p>
</div>
<div class="green topic">
<p class="topic-title first">Worked Example: Broadcasting</p>
<p>Let&#8217;s construct an array of distances (in miles) between cities of
Route 66: Chicago, Springfield, Saint-Louis, Tulsa, Oklahoma City,
Amarillo, Santa Fe, Albuquerque, Flagstaff and Los Angeles.</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mileposts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">736</span><span class="p">,</span> <span class="mi">871</span><span class="p">,</span> <span class="mi">1175</span><span class="p">,</span> <span class="mi">1475</span><span class="p">,</span> <span class="mi">1544</span><span class="p">,</span>
<div class="newline"></div><span class="gp">... </span>       <span class="mi">1913</span><span class="p">,</span> <span class="mi">2448</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mileposts</span> <span class="o">-</span> <span class="n">mileposts</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">distance_array</span>
<div class="newline"></div><span class="go">array([[   0,  198,  303,  736,  871, 1175, 1475, 1544, 1913, 2448],</span>
<div class="newline"></div><span class="go">       [ 198,    0,  105,  538,  673,  977, 1277, 1346, 1715, 2250],</span>
<div class="newline"></div><span class="go">       [ 303,  105,    0,  433,  568,  872, 1172, 1241, 1610, 2145],</span>
<div class="newline"></div><span class="go">       [ 736,  538,  433,    0,  135,  439,  739,  808, 1177, 1712],</span>
<div class="newline"></div><span class="go">       [ 871,  673,  568,  135,    0,  304,  604,  673, 1042, 1577],</span>
<div class="newline"></div><span class="go">       [1175,  977,  872,  439,  304,    0,  300,  369,  738, 1273],</span>
<div class="newline"></div><span class="go">       [1475, 1277, 1172,  739,  604,  300,    0,   69,  438,  973],</span>
<div class="newline"></div><span class="go">       [1544, 1346, 1241,  808,  673,  369,   69,    0,  369,  904],</span>
<div class="newline"></div><span class="go">       [1913, 1715, 1610, 1177, 1042,  738,  438,  369,    0,  535],</span>
<div class="newline"></div><span class="go">       [2448, 2250, 2145, 1712, 1577, 1273,  973,  904,  535,    0]])</span>
<div class="newline"></div></pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/route66.png"><img alt="../../_images/route66.png" class="align-center" src="../../_images/route66.png" style="width: 342.0px; height: 210.0px;" /></a>
</div>
<p>A lot of grid-based or network-based problems can also use
broadcasting. For instance, if we want to compute the distance from
the origin of points on a 10x10 grid, we can do</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span>
<div class="newline"></div><span class="go">array([[ 0.        ,  1.        ,  2.        ,  3.        ,  4.        ],</span>
<div class="newline"></div><span class="go">       [ 1.        ,  1.41421356,  2.23606798,  3.16227766,  4.12310563],</span>
<div class="newline"></div><span class="go">       [ 2.        ,  2.23606798,  2.82842712,  3.60555128,  4.47213595],</span>
<div class="newline"></div><span class="go">       [ 3.        ,  3.16227766,  3.60555128,  4.24264069,  5.        ],</span>
<div class="newline"></div><span class="go">       [ 4.        ,  4.12310563,  4.47213595,  5.        ,  5.65685425]])</span>
<div class="newline"></div></pre></div>
</div>
<p>Or in color:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>    
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>    
<div class="newline"></div></pre></div>
</div>
<p>[<a class="reference external" href="../../plot_directive/pyplots/numpy_intro_6.py">source code</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_6.hires.png">hires.png</a>, <a class="reference external" href="../../plot_directive/pyplots/numpy_intro_6.pdf">pdf</a>]</p>
<img alt="../../_images/numpy_intro_6.png" src="../../_images/numpy_intro_6.png" />
<p><strong>Remark</strong> : the <code class="docutils literal"><span class="pre">numpy.ogrid</span></code> function allows to directly create vectors x
and y of the previous example, with two &#8220;significant dimensions&#8221;:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<div class="newline"></div><span class="go">(array([[0],</span>
<div class="newline"></div><span class="go">       [1],</span>
<div class="newline"></div><span class="go">       [2],</span>
<div class="newline"></div><span class="go">       [3],</span>
<div class="newline"></div><span class="go">       [4]]), array([[0, 1, 2, 3, 4]]))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">((5, 1), (1, 5))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>So, <code class="docutils literal"><span class="pre">np.ogrid</span></code> is very useful as soon as we have to handle
computations on a grid. On the other hand, <code class="docutils literal"><span class="pre">np.mgrid</span></code> directly
provides matrices full of indices for cases where we can&#8217;t (or don&#8217;t
want to) benefit from broadcasting:</p>
<div class="last highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<div class="newline"></div><span class="go">array([[0, 0, 0, 0],</span>
<div class="newline"></div><span class="go">       [1, 1, 1, 1],</span>
<div class="newline"></div><span class="go">       [2, 2, 2, 2],</span>
<div class="newline"></div><span class="go">       [3, 3, 3, 3]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<div class="newline"></div><span class="go">array([[0, 1, 2, 3],</span>
<div class="newline"></div><span class="go">       [0, 1, 2, 3],</span>
<div class="newline"></div><span class="go">       [0, 1, 2, 3],</span>
<div class="newline"></div><span class="go">       [0, 1, 2, 3]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
</div>
<div class="section" id="array-shape-manipulation">
<h2><a class="toc-backref" href="#id5">1.3.2.4. Array shape manipulation</a><a class="headerlink" href="#array-shape-manipulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="flattening">
<h3>1.3.2.4.1. Flattening<a class="headerlink" href="#flattening" title="Permalink to this headline">¶</a></h3>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<div class="newline"></div><span class="go">array([1, 2, 3, 4, 5, 6])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">T</span>
<div class="newline"></div><span class="go">array([[1, 4],</span>
<div class="newline"></div><span class="go">       [2, 5],</span>
<div class="newline"></div><span class="go">       [3, 6]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<div class="newline"></div><span class="go">array([1, 4, 2, 5, 3, 6])</span>
<div class="newline"></div></pre></div>
</div>
<p>Higher dimensions: last dimensions ravel out &#8220;first&#8221;.</p>
</div>
<div class="section" id="reshaping">
<h3>1.3.2.4.2. Reshaping<a class="headerlink" href="#reshaping" title="Permalink to this headline">¶</a></h3>
<p>The inverse operation to flattening:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(2, 3)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<div class="newline"></div><span class="go">array([[1, 2, 3],</span>
<div class="newline"></div><span class="go">       [4, 5, 6]])</span>
<div class="newline"></div></pre></div>
</div>
<p>Or,</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>    <span class="c1"># unspecified (-1) value is inferred</span>
<div class="newline"></div><span class="go">array([[1, 2, 3],</span>
<div class="newline"></div><span class="go">       [4, 5, 6]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><code class="docutils literal"><span class="pre">ndarray.reshape</span></code> <strong>may</strong> return a view (cf <code class="docutils literal"><span class="pre">help(np.reshape)</span></code>)),
or copy</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[99,  2,  3],</span>
<div class="newline"></div><span class="go">       [ 4,  5,  6]])</span>
<div class="newline"></div></pre></div>
</div>
<p>Beware: reshape may also return a copy!:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[ 0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.],</span>
<div class="newline"></div><span class="go">       [ 0.,  0.]])</span>
<div class="newline"></div></pre></div>
</div>
<p class="last">To understand this you need to learn more about the memory layout of a numpy array.</p>
</div>
</div>
<div class="section" id="adding-a-dimension">
<h3>1.3.2.4.3. Adding a dimension<a class="headerlink" href="#adding-a-dimension" title="Permalink to this headline">¶</a></h3>
<p>Indexing with the <code class="docutils literal"><span class="pre">np.newaxis</span></code> object allows us to add an axis to an array
(you have seen this already above in the broadcasting section):</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<div class="newline"></div><span class="go">array([1, 2, 3])</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([[1],</span>
<div class="newline"></div><span class="go">       [2],</span>
<div class="newline"></div><span class="go">       [3]])</span>
<div class="newline"></div>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
<div class="newline"></div><span class="go">array([[1, 2, 3]])</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="dimension-shuffling">
<h3>1.3.2.4.4. Dimension shuffling<a class="headerlink" href="#dimension-shuffling" title="Permalink to this headline">¶</a></h3>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(4, 3, 2)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<div class="newline"></div><span class="go">5</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">shape</span>
<div class="newline"></div><span class="go">(3, 2, 4)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<div class="newline"></div><span class="go">5</span>
<div class="newline"></div></pre></div>
</div>
<p>Also creates a view:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<div class="newline"></div><span class="go">-1</span>
<div class="newline"></div></pre></div>
</div>
</div>
<div class="section" id="resizing">
<h3>1.3.2.4.5. Resizing<a class="headerlink" href="#resizing" title="Permalink to this headline">¶</a></h3>
<p>Size of an array can be changed with <code class="docutils literal"><span class="pre">ndarray.resize</span></code>:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">8</span><span class="p">,))</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([0, 1, 2, 3, 0, 0, 0, 0])</span>
<div class="newline"></div></pre></div>
</div>
<p>However, it must not be referred to somewhere else:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">4</span><span class="p">,))</span>   
<div class="newline"></div><span class="gt">Traceback (most recent call last):</span>
<div class="newline"></div>  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<div class="newline"></div><span class="gr">ValueError</span>: <span class="n">cannot resize an array that has been referenced or is</span>
<div class="newline"></div><span class="go">referencing another array in this way.  Use the resize function</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercise: Shape manipulations</strong></p>
<ul class="simple">
<li>Look at the docstring for <code class="docutils literal"><span class="pre">reshape</span></code>, especially the notes section which
has some more information about copies and views.</li>
<li>Use <code class="docutils literal"><span class="pre">flatten</span></code> as an alternative to <code class="docutils literal"><span class="pre">ravel</span></code>. What is the difference?
(Hint: check which one returns a view and which a copy)</li>
<li>Experiment with <code class="docutils literal"><span class="pre">transpose</span></code> for dimension shuffling.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="sorting-data">
<h2><a class="toc-backref" href="#id6">1.3.2.5. Sorting data</a><a class="headerlink" href="#sorting-data" title="Permalink to this headline">¶</a></h2>
<p>Sorting along an axis:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<div class="newline"></div><span class="go">array([[3, 4, 5],</span>
<div class="newline"></div><span class="go">       [1, 1, 2]])</span>
<div class="newline"></div></pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sorts each row separately!</p>
</div>
<p>In-place sort:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<div class="newline"></div><span class="go">array([[3, 4, 5],</span>
<div class="newline"></div><span class="go">       [1, 1, 2]])</span>
<div class="newline"></div></pre></div>
</div>
<p>Sorting with fancy indexing:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j</span>
<div class="newline"></div><span class="go">array([2, 3, 1, 0])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<div class="newline"></div><span class="go">array([1, 2, 3, 4])</span>
<div class="newline"></div></pre></div>
</div>
<p>Finding minima and maxima:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<div class="newline"></div><span class="gp">&gt;&gt;&gt; </span><span class="n">j_max</span><span class="p">,</span> <span class="n">j_min</span>
<div class="newline"></div><span class="go">(0, 2)</span>
<div class="newline"></div></pre></div>
</div>
<div class="green topic">
<p class="topic-title first"><strong>Exercise: Sorting</strong></p>
<blockquote>
<div><ul class="simple">
<li>Try both in-place and out-of-place sorting.</li>
<li>Try creating arrays with different dtypes and sorting them.</li>
<li>Use <code class="docutils literal"><span class="pre">all</span></code> or <code class="docutils literal"><span class="pre">array_equal</span></code> to check the results.</li>
<li>Look at <code class="docutils literal"><span class="pre">np.random.shuffle</span></code> for a way to create sortable input quicker.</li>
<li>Combine <code class="docutils literal"><span class="pre">ravel</span></code>, <code class="docutils literal"><span class="pre">sort</span></code> and <code class="docutils literal"><span class="pre">reshape</span></code>.</li>
<li>Look at the <code class="docutils literal"><span class="pre">axis</span></code> keyword for <code class="docutils literal"><span class="pre">sort</span></code> and rewrite the previous
exercise.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id7">1.3.2.6. Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p><strong>What do you need to know to get started?</strong></p>
<ul>
<li><p class="first">Know how to create arrays : <code class="docutils literal"><span class="pre">array</span></code>, <code class="docutils literal"><span class="pre">arange</span></code>, <code class="docutils literal"><span class="pre">ones</span></code>,
<code class="docutils literal"><span class="pre">zeros</span></code>.</p>
</li>
<li><p class="first">Know the shape of the array with <code class="docutils literal"><span class="pre">array.shape</span></code>, then use slicing
to obtain different views of the array: <code class="docutils literal"><span class="pre">array[::2]</span></code>,
etc. Adjust the shape of the array using <code class="docutils literal"><span class="pre">reshape</span></code> or flatten it
with <code class="docutils literal"><span class="pre">ravel</span></code>.</p>
</li>
<li><p class="first">Obtain a subset of the elements of an array and/or modify their values
with masks</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<div class="newline"></div></pre></div>
</div>
</li>
<li><p class="first">Know miscellaneous operations on arrays, such as finding the mean or max
(<code class="docutils literal"><span class="pre">array.max()</span></code>, <code class="docutils literal"><span class="pre">array.mean()</span></code>). No need to retain everything, but
have the reflex to search in the documentation (online docs,
<code class="docutils literal"><span class="pre">help()</span></code>, <code class="docutils literal"><span class="pre">lookfor()</span></code>)!!</p>
</li>
<li><p class="first">For advanced use: master the indexing with arrays of integers, as well as
broadcasting. Know more NumPy functions to handle various array
operations.</p>
</li>
</ul>
<div class="topic">
<p class="topic-title first"><strong>Quick read</strong></p>
<p>If you want to do a first quick pass through the Scipy lectures to
learn the ecosystem, you can directly skip to the next chapter:
<a class="reference internal" href="../matplotlib/index.html#matplotlib"><span class="std std-ref">Matplotlib: plotting</span></a>.</p>
<p>The remainder of this chapter is not necessary to follow the rest of
the intro part. But be sure to come back and finish this chapter, as
well as to do some more <a class="reference internal" href="exercises.html#numpy-exercises"><span class="std std-ref">exercices</span></a>.</p>
</div>
<p><div style="clear: both"></div></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
	<div class="sidebartoc">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.3.2. Numerical operations on arrays</a><ul>
<li><a class="reference internal" href="#elementwise-operations">1.3.2.1. Elementwise operations</a><ul>
<li><a class="reference internal" href="#basic-operations">1.3.2.1.1. Basic operations</a></li>
<li><a class="reference internal" href="#other-operations">1.3.2.1.2. Other operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-reductions">1.3.2.2. Basic reductions</a><ul>
<li><a class="reference internal" href="#computing-sums">1.3.2.2.1. Computing sums</a></li>
<li><a class="reference internal" href="#other-reductions">1.3.2.2.2. Other reductions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#broadcasting">1.3.2.3. Broadcasting</a></li>
<li><a class="reference internal" href="#array-shape-manipulation">1.3.2.4. Array shape manipulation</a><ul>
<li><a class="reference internal" href="#flattening">1.3.2.4.1. Flattening</a></li>
<li><a class="reference internal" href="#reshaping">1.3.2.4.2. Reshaping</a></li>
<li><a class="reference internal" href="#adding-a-dimension">1.3.2.4.3. Adding a dimension</a></li>
<li><a class="reference internal" href="#dimension-shuffling">1.3.2.4.4. Dimension shuffling</a></li>
<li><a class="reference internal" href="#resizing">1.3.2.4.5. Resizing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sorting-data">1.3.2.5. Sorting data</a></li>
<li><a class="reference internal" href="#summary">1.3.2.6. Summary</a></li>
</ul>
</li>
</ul>
</div>



    <div class="script_container">
    <script>
    (function() {
	var cx = '004523248466141510607:hgv2yimrahw';
	var gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
	    '//cse.google.com/cse.js?cx=' + cx;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(gcse, s);
    })();
    </script>
    <gcse:search></gcse:search>
    </div>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="elaborate_arrays.html" title="1.3.3. More elaborate arrays"
             >next</a></li>
        <li class="right" >
          <a href="array_object.html" title="1.3.1. The NumPy array object"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Scipy lecture notes</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >1. Getting started with Python for science</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >1.3. NumPy: creating and manipulating numerical data</a> &#187;</li>
     
    <!-- Insert a menu in the navigation bar -->
    <li class="left">
	<!-- On click toggle the 'tip' on or off-->
	<a onclick="$('.tip').each(function (index, obj) {
			    collapse_tip_div(obj);
		    });
		    $('.tip').addClass('collapsed');
		    $('.left').addClass('transparent');">
	<img src="../../_static/minus.png"
         alt="Collapse to compact view" style="padding: 1ex;"/>
	<span class="hiddenlink">Collapse document to compact view</span>
    </a></li>
    <li class="right edit_on_github"><a href="https://github.com/scipy-lectures/scipy-lecture-notes/edit/master/intro/numpy/operations.rst">Edit
    <span class="tooltip">
	Improve this page:<br/>Edit it on Github.
    </span>
    </a>
    </li>

      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012,2013,2015,2016.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>